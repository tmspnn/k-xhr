!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.kxhr=t():e.kxhr=t()}(this,(function(){return(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function s(e,t){return"function"==typeof e&&this.callbacks.push({type:"resolve",f:e}),"function"==typeof t&&this.callbacks.push({type:"reject",f:t}),this}function n(e){return this.then(null,e)}function o(){this.xhr.abort(),this.state="cancelled","function"==typeof this.onComplete&&this.onComplete(this)}function r(e){return"function"==typeof e&&(this.onComplete=e),this}function i(){if(this.result instanceof Object&&"function"==typeof this.result.then){for(var e;e=this.callbacks.shift();)"resolve"==e.type?this.result.then(e.f):"reject"==e.type&&this.result.catch(e.f);"function"==typeof this.onComplete&&"function"==typeof this.result.finally&&this.result.finally(this.onComplete)}else if(this.callbacks.length>0){var t=this.callbacks.shift();if("resolve"==t.type)try{this.result=t.f(this.result),this.resolve()}catch(e){this.state="rejected",this.err=e,this.reject()}else this.resolve()}else"function"==typeof this.onComplete&&this.onComplete(this)}function h(){if(this.callbacks.length>0){var e=this.callbacks.shift();"reject"==e.type?(this.result=e.f(this.err),this.state="resolved",this.resolve()):this.reject()}else{if("function"!=typeof this.onComplete)throw this.err;this.onComplete(this)}}function l(){this.xhr.status>=200&&this.xhr.status<400?(this.state="resolved",this.result=this.xhr.responseText,this.resolve()):this.onError()}function c(){this.state="rejected",this.err=new Error(this.xhr.responseText||this.xhr.statusText),this.reject()}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a={state:"pending",result:null,err:null,resolve:null,reject:null,callbacks:[],onComplete:null,xhr:new XMLHttpRequest};if("function"==typeof u.success&&a.callbacks.push({type:"resolve",f:u.success}),"function"==typeof u.fail&&a.callbacks.push({type:"reject",f:u.fail}),"function"==typeof u.complete&&(a.onComplete=u.complete),a.xhr.open(t.toUpperCase(),e,!0),u.contentType&&a.xhr.setRequestHeader("Content-Type",u.contentType),u.headers)for(var p in u.headers)u.headers.hasOwnProperty(p)&&a.xhr.setRequestHeader(p,u.headers[p]);return a.xhr.withCredentials=u.withCredentials||!1,a.xhr.timeout=u.timeout||0,a.xhr.onload=l.bind(a),a.xhr.onerror=c.bind(a),a.resolve=i.bind(a),a.reject=h.bind(a),a.then=s.bind(a),a.catch=n.bind(a),a.cancel=o.bind(a),a.finally=r.bind(a),"function"==u.onProgress&&(a.xhr.upload?a.xhr.upload.onprogress=u.onProgress:a.xhr.onprogress=u.onProgress),"function"==typeof u.beforeSend&&u.beforeSend(a.xhr),setTimeout((function(){return a.xhr.send(f)})),a}return e.d(t,{default:()=>f}),t.default})()}));
//# sourceMappingURL=k-xhr.js.map