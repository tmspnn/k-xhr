!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.kxhr=t():e.kxhr=t()}(this,(function(){return(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function s(e){return e instanceof Object&&"function"==typeof e.then}function n(e,t){return"function"==typeof e&&this.callbacks.push({type:"resolve",f:e}),"function"==typeof t&&this.callbacks.push({type:"reject",f:t}),this}function r(e){return this.then(null,e)}function o(){this.xhr.abort(),this.state="cancelled","function"==typeof this.onComplete&&this.onComplete(this)}function i(e){return"function"==typeof e&&(this.onComplete=e),this}function h(){for(let e=0;e<this.callbacks.length;++e){const t=this.callbacks[e];if(s(this.result))"resolve"==t.type?this.result.then(t.f):"reject"==t.type&&this.result.catch(t.f);else if("resolved"==this.state&&"resolve"==t.type)try{this.result=t.f(this.result)}catch(e){this.state="rejected",this.err=e}else"rejected"==this.state&&"reject"==t.type&&(this.result=t.f(this.err),this.state="resolved")}"function"==typeof this.onComplete&&(s(this.result)?"function"==typeof this.result.finally&&this.result.finally(this.onComplete):this.onComplete(this))}function l(){this.xhr.status>=200&&this.xhr.status<400?(this.state="resolved",this.result=this.xhr.response,this.next()):this.xhr.onerror()}function c(){this.state="rejected",this.err=new Error(this.xhr.response||this.xhr.statusText),this.next()}function u(e,t="get",s=null,u={}){const f={state:"pending",result:null,err:null,resolve:null,reject:null,callbacks:[],onComplete:null,xhr:new XMLHttpRequest};if("function"==typeof u.success&&f.callbacks.push({type:"resolve",f:u.success}),"function"==typeof u.fail&&f.callbacks.push({type:"reject",f:u.fail}),"function"==typeof u.complete&&(f.onComplete=u.complete),f.xhr.open(t.toUpperCase(),e,!0),u.contentType&&f.xhr.setRequestHeader("Content-Type",u.contentType),u.headers)for(let e in u.headers)u.headers.hasOwnProperty(e)&&f.xhr.setRequestHeader(e,u.headers[e]);return f.xhr.withCredentials=u.withCredentials||!1,f.xhr.timeout=u.timeout||0,f.xhr.onload=l.bind(f),f.xhr.onerror=c.bind(f),f.next=h.bind(f),f.then=n.bind(f),f.catch=r.bind(f),f.cancel=o.bind(f),f.finally=i.bind(f),"function"==u.onProgress&&(f.xhr.upload?f.xhr.upload.onprogress=u.onProgress:f.xhr.onprogress=u.onProgress),"function"==typeof u.beforeSend&&u.beforeSend(f.xhr),setTimeout((()=>f.xhr.send(s))),f}return e.d(t,{default:()=>u}),t.default})()}));