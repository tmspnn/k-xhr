!function(I,g){"object"==typeof exports&&"object"==typeof module?module.exports=g():"function"==typeof define&&define.amd?define([],g):"object"==typeof exports?exports.Kxhr=g():I.Kxhr=g()}(this,function(){return function(I){var g={};function C(A){if(g[A])return g[A].exports;var n=g[A]={i:A,l:!1,exports:{}};return I[A].call(n.exports,n,n.exports,C),n.l=!0,n.exports}return C.m=I,C.c=g,C.d=function(I,g,A){C.o(I,g)||Object.defineProperty(I,g,{enumerable:!0,get:A})},C.r=function(I){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},C.t=function(I,g){if(1&g&&(I=C(I)),8&g)return I;if(4&g&&"object"==typeof I&&I&&I.__esModule)return I;var A=Object.create(null);if(C.r(A),Object.defineProperty(A,"default",{enumerable:!0,value:I}),2&g&&"string"!=typeof I)for(var n in I)C.d(A,n,function(g){return I[g]}.bind(null,n));return A},C.n=function(I){var g=I&&I.__esModule?function(){return I.default}:function(){return I};return C.d(g,"a",g),g},C.o=function(I,g){return Object.prototype.hasOwnProperty.call(I,g)},C.p="",C(C.s=0)}([function(module,exports,__webpack_require__){"use strict";eval('\nObject.defineProperty(exports, "__esModule", { value: true });\nvar XhrPromise = /** @class */ (function () {\n    function XhrPromise(options) {\n        var _this = this;\n        this.state = "pending";\n        this.value = null;\n        this.error = null;\n        this.callbacks = [];\n        this.finallyHandler = null;\n        this.xhr = new XMLHttpRequest();\n        this.onLoad = function () {\n            var xhr = _this.xhr;\n            if (xhr.status >= 200 && xhr.status < 400) {\n                _this.state = "fulfilled";\n                _this.value = xhr.responseText;\n                _this.resolve();\n            }\n            else {\n                _this.onError();\n            }\n        };\n        this.onError = function () {\n            var xhr = _this.xhr;\n            _this.state = "rejected";\n            _this.error = new Error(xhr.responseText || xhr.statusText);\n            _this.reject();\n        };\n        this.resolve = function () {\n            var _a;\n            if (_this.value instanceof XhrPromise) {\n                var p = _this.value;\n                (_a = p.callbacks).push.apply(_a, _this.callbacks);\n                p.finallyHandler = _this.finallyHandler;\n                _this.callbacks.length = 0;\n                _this.finallyHandler = null;\n            }\n            else if (_this.callbacks.length) {\n                var cb = _this.callbacks.shift();\n                if (cb.type == "resolve") {\n                    try {\n                        _this.value = cb.handler(_this.value);\n                        _this.resolve();\n                    }\n                    catch (e) {\n                        _this.state = "rejected";\n                        _this.error = e;\n                        _this.reject();\n                    }\n                }\n                else {\n                    _this.resolve();\n                }\n            }\n            else if (_this.finallyHandler) {\n                _this.finallyHandler(_this.xhr);\n            }\n        };\n        this.reject = function () {\n            if (_this.callbacks.length) {\n                var cb = _this.callbacks.shift();\n                if (cb.type == "reject") {\n                    _this.value = cb.handler(_this.error);\n                    _this.state = "fulfilled";\n                    _this.resolve();\n                }\n                else {\n                    _this.reject();\n                }\n            }\n            else if (_this.finallyHandler) {\n                _this.finallyHandler(_this.xhr);\n            }\n            else {\n                throw _this.error;\n            }\n        };\n        this.then = function (onResolve, onReject) {\n            _this.callbacks.push({ type: "resolve", handler: onResolve });\n            if (onReject)\n                _this.callbacks.push({ type: "reject", handler: onReject });\n            return _this;\n        };\n        this.catch = function (onReject) {\n            _this.callbacks.push({ type: "reject", handler: onReject });\n            return _this;\n        };\n        this.cancel = function () {\n            _this.xhr.abort();\n        };\n        this.finally = function (onComplete) {\n            _this.finallyHandler = onComplete;\n            return _this;\n        };\n        var xhr = this.xhr;\n        var url = options.url, method = options.method, async = options.async, contentType = options.contentType, headers = options.headers, withCredentials = options.withCredentials, data = options.data, beforeSend = options.beforeSend, onProgress = options.onProgress, timeout = options.timeout;\n        xhr.open((method || "get").toUpperCase(), url, async != false);\n        if (contentType)\n            xhr.setRequestHeader("Content-Type", contentType);\n        if (headers) {\n            for (var h in headers) {\n                if (headers.hasOwnProperty(h)) {\n                    xhr.setRequestHeader(h, headers[h]);\n                }\n            }\n        }\n        xhr.withCredentials = withCredentials || false;\n        xhr.timeout = timeout || 0;\n        xhr.onload = this.onLoad;\n        xhr.onerror = this.onError;\n        if (xhr.upload && onProgress)\n            xhr.upload.onprogress = onProgress;\n        if (beforeSend)\n            beforeSend(xhr);\n        setTimeout(function () { return xhr.send(data); });\n    }\n    return XhrPromise;\n}());\nexports.default = XhrPromise;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL0t4aHIvLi9rLXhoci50cz8yNTQwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFhoclByb21pc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gWGhyUHJvbWlzZShvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBcInBlbmRpbmdcIjtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuICAgICAgICB0aGlzLmNhbGxiYWNrcyA9IFtdO1xuICAgICAgICB0aGlzLmZpbmFsbHlIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy54aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgdGhpcy5vbkxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gX3RoaXMueGhyO1xuICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zdGF0ZSA9IFwiZnVsZmlsbGVkXCI7XG4gICAgICAgICAgICAgICAgX3RoaXMudmFsdWUgPSB4aHIucmVzcG9uc2VUZXh0O1xuICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLm9uRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbkVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHhociA9IF90aGlzLnhocjtcbiAgICAgICAgICAgIF90aGlzLnN0YXRlID0gXCJyZWplY3RlZFwiO1xuICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBuZXcgRXJyb3IoeGhyLnJlc3BvbnNlVGV4dCB8fCB4aHIuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICBfdGhpcy5yZWplY3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZXNvbHZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgaWYgKF90aGlzLnZhbHVlIGluc3RhbmNlb2YgWGhyUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHZhciBwID0gX3RoaXMudmFsdWU7XG4gICAgICAgICAgICAgICAgKF9hID0gcC5jYWxsYmFja3MpLnB1c2guYXBwbHkoX2EsIF90aGlzLmNhbGxiYWNrcyk7XG4gICAgICAgICAgICAgICAgcC5maW5hbGx5SGFuZGxlciA9IF90aGlzLmZpbmFsbHlIYW5kbGVyO1xuICAgICAgICAgICAgICAgIF90aGlzLmNhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIF90aGlzLmZpbmFsbHlIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKF90aGlzLmNhbGxiYWNrcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2IgPSBfdGhpcy5jYWxsYmFja3Muc2hpZnQoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2IudHlwZSA9PSBcInJlc29sdmVcIikge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudmFsdWUgPSBjYi5oYW5kbGVyKF90aGlzLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RhdGUgPSBcInJlamVjdGVkXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5lcnJvciA9IGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKF90aGlzLmZpbmFsbHlIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZmluYWxseUhhbmRsZXIoX3RoaXMueGhyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZWplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuY2FsbGJhY2tzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBjYiA9IF90aGlzLmNhbGxiYWNrcy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgIGlmIChjYi50eXBlID09IFwicmVqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmFsdWUgPSBjYi5oYW5kbGVyKF90aGlzLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RhdGUgPSBcImZ1bGZpbGxlZFwiO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChfdGhpcy5maW5hbGx5SGFuZGxlcikge1xuICAgICAgICAgICAgICAgIF90aGlzLmZpbmFsbHlIYW5kbGVyKF90aGlzLnhocik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50aGVuID0gZnVuY3Rpb24gKG9uUmVzb2x2ZSwgb25SZWplY3QpIHtcbiAgICAgICAgICAgIF90aGlzLmNhbGxiYWNrcy5wdXNoKHsgdHlwZTogXCJyZXNvbHZlXCIsIGhhbmRsZXI6IG9uUmVzb2x2ZSB9KTtcbiAgICAgICAgICAgIGlmIChvblJlamVjdClcbiAgICAgICAgICAgICAgICBfdGhpcy5jYWxsYmFja3MucHVzaCh7IHR5cGU6IFwicmVqZWN0XCIsIGhhbmRsZXI6IG9uUmVqZWN0IH0pO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNhdGNoID0gZnVuY3Rpb24gKG9uUmVqZWN0KSB7XG4gICAgICAgICAgICBfdGhpcy5jYWxsYmFja3MucHVzaCh7IHR5cGU6IFwicmVqZWN0XCIsIGhhbmRsZXI6IG9uUmVqZWN0IH0pO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnhoci5hYm9ydCgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmZpbmFsbHkgPSBmdW5jdGlvbiAob25Db21wbGV0ZSkge1xuICAgICAgICAgICAgX3RoaXMuZmluYWxseUhhbmRsZXIgPSBvbkNvbXBsZXRlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgeGhyID0gdGhpcy54aHI7XG4gICAgICAgIHZhciB1cmwgPSBvcHRpb25zLnVybCwgbWV0aG9kID0gb3B0aW9ucy5tZXRob2QsIGFzeW5jID0gb3B0aW9ucy5hc3luYywgY29udGVudFR5cGUgPSBvcHRpb25zLmNvbnRlbnRUeXBlLCBoZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzLCB3aXRoQ3JlZGVudGlhbHMgPSBvcHRpb25zLndpdGhDcmVkZW50aWFscywgZGF0YSA9IG9wdGlvbnMuZGF0YSwgYmVmb3JlU2VuZCA9IG9wdGlvbnMuYmVmb3JlU2VuZCwgb25Qcm9ncmVzcyA9IG9wdGlvbnMub25Qcm9ncmVzcywgdGltZW91dCA9IG9wdGlvbnMudGltZW91dDtcbiAgICAgICAgeGhyLm9wZW4oKG1ldGhvZCB8fCBcImdldFwiKS50b1VwcGVyQ2FzZSgpLCB1cmwsIGFzeW5jICE9IGZhbHNlKTtcbiAgICAgICAgaWYgKGNvbnRlbnRUeXBlKVxuICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgY29udGVudFR5cGUpO1xuICAgICAgICBpZiAoaGVhZGVycykge1xuICAgICAgICAgICAgZm9yICh2YXIgaCBpbiBoZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoaCwgaGVhZGVyc1toXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB3aXRoQ3JlZGVudGlhbHMgfHwgZmFsc2U7XG4gICAgICAgIHhoci50aW1lb3V0ID0gdGltZW91dCB8fCAwO1xuICAgICAgICB4aHIub25sb2FkID0gdGhpcy5vbkxvYWQ7XG4gICAgICAgIHhoci5vbmVycm9yID0gdGhpcy5vbkVycm9yO1xuICAgICAgICBpZiAoeGhyLnVwbG9hZCAmJiBvblByb2dyZXNzKVxuICAgICAgICAgICAgeGhyLnVwbG9hZC5vbnByb2dyZXNzID0gb25Qcm9ncmVzcztcbiAgICAgICAgaWYgKGJlZm9yZVNlbmQpXG4gICAgICAgICAgICBiZWZvcmVTZW5kKHhocik7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4geGhyLnNlbmQoZGF0YSk7IH0pO1xuICAgIH1cbiAgICByZXR1cm4gWGhyUHJvbWlzZTtcbn0oKSk7XG5leHBvcnRzLmRlZmF1bHQgPSBYaHJQcm9taXNlO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n')}]).default});